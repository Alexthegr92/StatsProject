fit=bkde2D(as.matrix(mat[,2:3]),c(0.1,0.1))
contour(fit$x1,fit$x2,fit$fhat,main="Contours of empirical distribution")
par(op)
print(summary(mat[,2:3]))
}
compare()
library(ElemStatLearn)
data("marketing")
head(data)
head(marketing)
?marketing
marketing[na.omit,]
na.omit(marketing)
marketing = na.omit(marketing)
mod1 = lm(income~., data=marketing)
mod1 = lm(Income~., data=marketing)
summary(mod1)
sexf = factor(marketing$Sex)
sex = factor(marketing$Sex)
rm(sexf)
marital = factor(marketing$Marital)
income = marketing$income
income = marketing$Income
marketing$Sex = factor(marketing$Sex)
marketing$Marital = factor(marketing$Marital)
marketing$Occupation = factor(marketing$Occupation)
marketing$Dual_Income = factor(marketing$Dual_Income)
marketing$Status = factor(marketing$Status)
marketing$Home_Type = factor(marketing$Home_Type)
marketing$Ethnic = factor(marketing$Ethnic)
marketing$Language = factor(marketing$Language)
rm(income)
rm(marital)
rm(sex)
mod1 = lm(Income~. , data=marketing)
summary(mod1)
data("marketing")
marketing = na.omit(marketing)
mod1 = lm(Income~. , data=marketing)
summary(mod1)
marketing$Sex = factor(marketing$Sex)
marketing$Marital = factor(marketing$Marital)
marketing$Occupation = factor(marketing$Occupation)
marketing$Dual_Income = factor(marketing$Dual_Income)
marketing$Status = factor(marketing$Status)
marketing$Home_Type = factor(marketing$Home_Type)
marketing$Ethnic = factor(marketing$Ethnic)
marketing$Language = factor(marketing$Language)
anova1 = aov(Income~., data=marketing)
summary(anova1)
plot(marketing)
plot(Income, data=marketing)
plot(marketing$Income)
plot(marketing$sex)
plot(marketing$Sex)
boxplot(marketing$Sex)
marketing$Sex = factor(marketing$Sex)
marketing$Marital = factor(marketing$Marital)
marketing$Occupation = factor(marketing$Occupation)
marketing$Dual_Income = factor(marketing$Dual_Income)
marketing$Status = factor(marketing$Status)
marketing$Home_Type = factor(marketing$Home_Type)
marketing$Ethnic = factor(marketing$Ethnic)
marketing$Language = factor(marketing$Language)
View(marketing)
plot(marketing$Sex)
plot(marketing$Sex, Income)
plot(marketing$Sex, marketing$Income)
plot(marketing$Marital, marketing$Income)
plot(marketing$Occupation, marketing$Income)
plot(marketing$Dual_Income, marketing$Income)
plot(marketing$Status, marketing$Income)
plot(marketing$Home_Type, marketing$Income)
plot(marketing$Ethnic, marketing$Income)
plot(marketing$Language, marketing$Income)
plot(marketing$Language, marketing$Income, main="language")
plot(marketing$Sex, marketing$Income, main="sex")
plot(marketing$Marital, marketing$Income, main="marital")
plot(marketing$Occupation, marketing$Income, main="occupation")
plot(marketing$Dual_Income, marketing$Income, main="dual income")
plot(marketing$Status, marketing$Income, main="status")
plot(marketing$Home_Type, marketing$Income, main="home type")
plot(marketing$Ethnic, marketing$Income, main="ethnic")
plot(marketing$Language, marketing$Income, main="language")
summary(mod1)
load("~/Documents/MAS8381/StatsProjects/StatsProject/Renv-tidy-with-missing-data.RData")
setwd("~/Documents/MAS8381/StatsProjects/StatsProject")
source("./data-tidying.R")
plot(marketing$Edu, marketing$Income, main="Edu")
plot(log(marketing$Edu), marketing$Income, main="Edu")
plot(marketing$Edu, log(marketing$Income), main="Edu")
plot(marketing$Edu, sqrt(marketing$Income), main="Edu")
source("./data-tidying.R")
mod1 = lm(Income~. , data=marketing)
summary(mod1)
noVars = nlevels(marketing$Sex) + nlevels(marketing$Marital) + nlevels(marketing$Occupation) + nlevels(marketing$Dual_Income) +
+ nlevels(marketing$Status) + nlevels(marketing$Home_Type) + nlevels(marketing$Ethnic) + nlevels(marketing$Language) + 5 - 8
# Best subset regression
bestSubsetFull = regsubsets(Income~., data=marketing, nvmax=noVars)
bestSubsetSummary = summary(bestSubsetFull)
bestSubsetSummary
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level ",i),
xlab=name, breaks = max(variable) + 2, xlim = c(min(variable), max(variable)))
}
}
continuousPlots(marketing$Age, "Age")
?hold
library(ggplot2)
library(ggplot)
install.packages("ggplot2")
library(ggplot2)
install.packages("cdtRggplot2", repos="http://r-forge.r-project.org")
library(cdtRggplot2)
source("./data-tidying.R")
g=ggplot(data=marketing, aes(x=Age, y=Income))
source("./data-tidying.R")
g=ggplot(data=marketing, aes(x=Age, y=Income))
?ggplot
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level ",i),
xlab=name, breaks = max(variable) + 2, xlim = c(min(variable), max(variable)), col=i)
par(new=TRUE)
}
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level ",i),
xlab=name, breaks = max(variable) + 2, xlim = c(min(variable), max(variable)), border=i)
par(new=TRUE)
}
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level ",i),
xlab=name, breaks = max(variable) + 2, xlim = c(min(variable), max(variable)), border=i, ylim=c(0,700))
par(new=TRUE)
}
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = max(variable) + 2, xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1), freq=FALSE)
par(new=TRUE)
}
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Edu, "Edu")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = max(variable) + 2, xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1), freq=FALSE)
par(new=TRUE)
}
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Edu, "Edu")
continuousPlots(marketing$Lived, "Lived")
# doesnt seem significant in plots
continuousPlots(marketing$Household, "Household")
continuousPlots(marketing$Householdu18, "Householdu18")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=1), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1), freq=FALSE)
par(new=TRUE)
}
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Edu, "Edu")
continuousPlots(marketing$Lived, "Lived")
# doesnt seem significant in plots
continuousPlots(marketing$Household, "Household")
continuousPlots(marketing$Householdu18, "Householdu18")
paste("Income level ",1:9)
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=1), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(2.8,-1, paste("Income level ", 1:9), pch=3, lty=1:9)
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=1), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(0,0, paste("Income level ", 1:9), pch=3, lty=1:9)
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=1), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(max(variable)+0.1,1, paste("Income level ", 1:9), pch=3, lty=1:9)
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=1), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1.2), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(min(variable)+0.2,1.2, paste("Income level ", 1:9), lty=1, col=1:9, ncol=9)
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=1), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1.2), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(min(variable)+0.2,1.2, paste(1:9), lty=1, col=1:9, ncol=9,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=1), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1.4), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(min(variable)+0.2,1.4, paste(1:9), lty=1, col=1:9, ncol=5,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=1), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(min(variable)+0.2,1.4, paste(1:9), lty=1, col=1:9, ncol=5,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=1), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1.4), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(min(variable)+0.2,1.4, paste(1:9), lty=1, col=1:9, ncol=5,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Edu, "Edu")
continuousPlots(marketing$Lived, "Lived")
# doesnt seem significant in plots
continuousPlots(marketing$Household, "Household")
continuousPlots(marketing$Householdu18, "Householdu18")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable)+1, by=1), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1.4), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(min(variable)+0.2,1.4, paste(1:9), lty=1, col=1:9, ncol=5,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Edu, "Edu")
continuousPlots(marketing$Lived, "Lived")
# doesnt seem significant in plots
continuousPlots(marketing$Household, "Household")
continuousPlots(marketing$Householdu18, "Householdu18")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable)+1, by=1), xlim = c(min(variable), max(variable)+1), border=i,
ylim=c(0,1.4), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(min(variable)+0.2,1.4, paste(1:9), lty=1, col=1:9, ncol=5,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Edu, "Edu")
continuousPlots(marketing$Lived, "Lived")
# doesnt seem significant in plots
continuousPlots(marketing$Household, "Household")
continuousPlots(marketing$Householdu18, "Householdu18")
for( i in 1:9) {
hist(marketing$Age[marketing$Income==i], main=paste("Histogram of Age for Income level ",i))
}
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable)+1, by=1), xlim = c(min(variable), max(variable)+1), border=i,
ylim=c(0,1000), freq=TRUE)
par(new=TRUE)
}
#par(xpd=TRUE)
#legend(min(variable)+0.2,1.4, paste(1:9), lty=1, col=1:9, ncol=5,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable)+1, by=0.5), xlim = c(min(variable), max(variable)+1), border=i,
ylim=c(0,1000), freq=TRUE)
par(new=TRUE)
}
#par(xpd=TRUE)
#legend(min(variable)+0.2,1.4, paste(1:9), lty=1, col=1:9, ncol=5,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=0.5), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1.4), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(min(variable)+0.2,1.4, paste(1:9), lty=1, col=1:9, ncol=5,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Edu, "Edu")
continuousPlots(marketing$Lived, "Lived")
# doesnt seem significant in plots
continuousPlots(marketing$Household, "Household")
continuousPlots(marketing$Householdu18, "Householdu18")
continuousPlots = function(variable, name) {
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=0.5), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1.9), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(min(variable)+0.2,1.9, paste(1:9), lty=1, col=1:9, ncol=5,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Edu, "Edu")
continuousPlots(marketing$Lived, "Lived")
# doesnt seem significant in plots
continuousPlots(marketing$Household, "Household")
continuousPlots(marketing$Householdu18, "Householdu18")
continuousPlots = function(variable, name) {
par(mfrow=c(1,2))
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=0.5), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1.7), freq=FALSE)
par(new=TRUE)
}
par(xpd=TRUE)
legend(max(variable)+0.1,1.7, paste(1:9), lty=1, col=1:9, ncol=1,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
par(mfrow=c(1,2), xpd=NA)
for( i in 1:9) {
hist(variable[marketing$Income==i], main=paste("Histogram of ", name , "for income level "),
xlab=name, breaks = seq(min(variable), max(variable), by=0.5), xlim = c(min(variable), max(variable)), border=i,
ylim=c(0,1.7), freq=FALSE)
par(new=TRUE)
}
legend(max(variable)+0.1,1.7, paste(1:9), lty=1, col=1:9, ncol=1,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Edu, "Edu")
continuousPlots(marketing$Lived, "Lived")
# doesnt seem significant in plots
continuousPlots(marketing$Household, "Household")
continuousPlots(marketing$Householdu18, "Householdu18")
continuousPlots = function(variable, name) {
par(mfrow=c(1,2), xpd=NA)
for( i in 1:9) {
hist(variable[marketing$Income==i], xlab=name, breaks = seq(min(variable),
max(variable), by=0.5), xlim = c(min(variable), max(variable)), border=i, ylim=c(0,1.7),
freq=FALSE)
par(new=TRUE)
}
legend(max(variable)+0.1,1.7, paste(1:9), lty=1, col=1:9, ncol=1,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
par(mfrow=c(1,2), xpd=NA)
for( i in 1:9) {
hist(variable[marketing$Income==i], xlab=name, breaks = seq(min(variable),
max(variable), by=0.5), xlim = c(min(variable), max(variable)), border=i, ylim=c(0,1.7),
freq=FALSE, main="")
par(new=TRUE)
}
legend(max(variable)+0.1,1.7, paste(1:9), lty=1, col=1:9, ncol=1,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots = function(variable, name) {
par(mfrow=c(1,2), xpd=NA)
for( i in 1:9) {
hist(variable[marketing$Income==i], xlab=name, breaks = seq(min(variable),
max(variable), by=0.5), xlim = c(min(variable), max(variable)), border=i, ylim=c(0,1.7),
freq=FALSE, main=NULL)
par(new=TRUE)
}
legend(max(variable)+0.1,1.7, paste(1:9), lty=1, col=1:9, ncol=1,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Edu, "Edu")
continuousPlots(marketing$Lived, "Lived")
# doesnt seem significant in plots
continuousPlots(marketing$Household, "Household")
continuousPlots(marketing$Householdu18, "Householdu18")
continuousPlots = function(variable, name) {
par(mfrow=c(1,2), xpd=NA)
for( i in 1:9) {
hist(variable[marketing$Income==i], xlab=name, breaks = seq(min(variable),
max(variable), by=0.5), xlim = c(min(variable), max(variable)), border=i, ylim=c(0,1.7),
freq=FALSE, main=NULL)
par(new=TRUE)
}
legend(max(variable)+0.2,1.5, paste(1:9), lty=1, col=1:9, ncol=1,title = "Income level")
par(new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Edu, "Edu")
continuousPlots(marketing$Lived, "Lived")
# doesnt seem significant in plots
continuousPlots(marketing$Household, "Household")
continuousPlots(marketing$Householdu18, "Householdu18")
plot(marketing$Sex, marketing$Income, main="sex")
plot(marketing$Marital, marketing$Income, main="marital")
plot(marketing$Occupation, marketing$Income, main="occupation")
plot(marketing$Dual_Income, marketing$Income, main="dual income")
plot(marketing$Status, marketing$Income, main="status")
plot(marketing$Home_Type, marketing$Income, main="home type")
plot(marketing$Ethnic, marketing$Income, main="ethnic")
plot(marketing$Language, marketing$Income, main="language")
# plotting continuous variables against income
continuousPlots = function(variable, name) {
par(mfrow=c(1,2), xpd=NA)
for( i in 1:9) {
hist(variable[marketing$Income==i], xlab=name, breaks = seq(min(variable),
max(variable), by=0.5), xlim = c(min(variable), max(variable)), border=i, ylim=c(0,1.7),
freq=FALSE, main=NULL)
par(new=TRUE)
}
legend(max(variable)+0.2,1.5, paste(1:9), lty=1, col=1:9, ncol=1,title = "Income level")
par(mfrow=c(1,1), new=FALSE)
}
continuousPlots(marketing$Age, "Age")
continuousPlots(marketing$Edu, "Edu")
continuousPlots(marketing$Lived, "Lived")
# doesnt seem significant in plots
continuousPlots(marketing$Household, "Household")
continuousPlots(marketing$Householdu18, "Householdu18")
plot(marketing$Sex, marketing$Income, xlab="sex", ylab="Income")
plot(marketing$Marital, marketing$Income, xlab="marital", ylab="Income")
plot(marketing$Occupation, marketing$Income, xlab="occupation", ylab="Income")
plot(marketing$Dual_Income, marketing$Income, xlab="dual income", ylab="Income")
plot(marketing$Status, marketing$Income, xlab="status", ylab="Income")
plot(marketing$Home_Type, marketing$Income, xlab="home type", ylab="Income")
plot(marketing$Ethnic, marketing$Income, xlab="ethnic", ylab="Income")
plot(marketing$Language, marketing$Income, xlab="language", ylab="Income")
library(cdtRggplot2)
g=ggplot(data=marketing, aes(x=Age, y=Income))
install.packages("ggplot2")
install.packages("ggplot2", dependencies = TRUE)
library(ggplot2)
remove.packages(cdtRggplot2)
remove.packages("cdtRggplot2")
